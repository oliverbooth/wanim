import{b as A,c as N,A as v,t as b}from"./wanim-scene-example.Cq1RX7Ki.js";import{W}from"./wgroup.DY3EG0F5.js";let F=null;function S(){return F||(F=new Promise((o,n)=>{if(window.MathJax)return o();const a=document.createElement("script");a.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js",a.async=!0,window.MathJax={loader:{load:["input/tex","output/svg"]},tex:{packages:["base","ams"]},svg:{fontCache:"none"},startup:{ready:()=>{window.MathJax.startup.defaultReady(),o()}}},a.onerror=n,document.head.appendChild(a)}),F)}async function C(o,n=!0){await S();const s=window.MathJax.tex2svg(o,{display:n}).firstElementChild;return s.style.fontSize="1",s}class J extends A{w;h;constructor(n=0,a=0,s=1,e=1){super(n,a),this.w=s,this.h=e,this.path=N.fromPoints([[0,0],[s,0],[s,e],[0,e]]),this.renderPath()}get size(){return[this.w,this.h]}}class L extends W{rendered;constructor(n,a){super(0,0),a={fontScale:1.5,...a},this.rendered=new Promise(s=>{C(n).then(e=>{const u=e.getAttribute("viewBox"),[p,g,,y]=u.split(" ").map(Number),c=a.fontScale/y;this.position=[p*c,-g*c];const P=(E,f,m,h,d)=>{if(E.nodeType===Node.ELEMENT_NODE){const r=E;if(r.tagName==="g"){const w=r.getAttribute("transform"),l=r.getAttribute("transform");if(l){const i=l.match(/scale\(([^,]+),([^)]+)\)/);i&&(h*=parseFloat(i[1]),d*=parseFloat(i[2]))}if(w){const i=w.match(/translate\(([^,]+),([^)]+)\)/);i&&(f+=parseFloat(i[1])*c*h,m+=parseFloat(i[2])*c*d)}r.setAttribute("transform",`translate(${f}, ${m}) scale(${h}, ${d})`)}else if(r.tagName==="path"){const l=r.getAttribute("d").replace(/([0-9.-]+)/g,t=>(parseFloat(t)*c).toFixed(6));r.setAttribute("d",l);const i=r.getAttribute("transform"),x=r.getAttribute("transform");if(x){const t=x.match(/scale\(([^,]+),([^)]+)\)/);t&&(h*=parseFloat(t[1]),d*=parseFloat(t[2]))}if(i){const t=i.match(/translate\(([^,]+),([^)]+)\)/);t&&(f+=parseFloat(t[1])*c*h,m+=parseFloat(t[2])*c*d)}try{const t=A.fromSVGPath(r.getAttribute("d"));t.position=[f,m],t.scale=[h,d],t.setFill("none"),t.setStroke("white"),t.setStrokeWidth(.05),this.add(t)}catch(t){console.error(t)}return}else if(r.tagName==="rect"){const w=parseFloat(r.getAttribute("width"))*c*h,l=parseFloat(r.getAttribute("height"))*c*d,i=parseFloat(r.getAttribute("x"))*c*h+f,x=parseFloat(r.getAttribute("y"))*c*d+m,t=new J(i,x,w,l);t.setFill("white"),t.anchor=v.TopLeft,this.add(t)}}E.childNodes.forEach(r=>{P(r,f,m,h,d)})};P(e,0,0,1,1),this.updateTransform(),s()})})}createElement(){return document.createElementNS("http://www.w3.org/2000/svg","g")}}function $(o){if(o instanceof L){const n=o.children.filter(e=>e instanceof A);if(n.length===0)throw new Error("Create animation can only be applied to groups containing WPathObjects.");const a=n.map(e=>e.path.clone()),s=n.map(e=>e.path.getLength());return b().onPlay(()=>n.forEach(e=>e.show())).onUpdate(e=>{if(e<=.5){const u=e*2;n.forEach((p,g)=>{p.path=a[g].truncate(u*s[g]),p.renderPath()})}else{const u=(e-.5)*2;n.forEach((p,g)=>{p.setFill("white",u),p.setStrokeWidth(.05*(1-u))})}}).duration(1)}if(o instanceof A){const n=o.path.clone(),a=n.getLength();return b().onPlay(()=>o.show()).onUpdate(s=>{o.path=n.truncate(s*a),o.renderPath()}).duration(.5)}throw new Error("")}export{$ as C,L as W};
