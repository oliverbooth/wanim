import{b as F,c as N,A as v,t as P}from"./wanim-scene-example.BF4PekrL.js";import{W}from"./wgroup.uHJ3ojvL.js";let A=null;function C(){return A||(A=new Promise((o,r)=>{if(window.MathJax)return o();const a=document.createElement("script");a.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js",a.async=!0,window.MathJax={loader:{load:["input/tex","output/svg"]},tex:{packages:["base","ams"]},svg:{fontCache:"none"},startup:{ready:()=>{window.MathJax.startup.defaultReady(),o()}}},a.onerror=r,document.head.appendChild(a)}),A)}async function J(o,r=!0){await C();const s=window.MathJax.tex2svg(o,{display:r}).firstElementChild;return s.style.fontSize="1",s}class L extends F{w;h;constructor(r=0,a=0,s=1,e=1){super(r,a),this.w=s,this.h=e,this.path=N.fromPoints([[0,0],[s,0],[s,e],[0,e]]),this.renderPath()}get size(){return[this.w,this.h]}}class M extends W{rendered;constructor(r,a){super(0,0),a={fontScale:1.5,...a},this.rendered=new Promise(s=>{J(r).then(e=>{const f=e.getAttribute("viewBox"),[d,g,,b]=f.split(" ").map(Number),c=a.fontScale/b;this.position=[d*c,-g*c];const E=(y,u,m,h,p)=>{if(y.nodeType===Node.ELEMENT_NODE){const n=y;if(n.tagName==="g"){const w=n.getAttribute("transform"),l=n.getAttribute("transform");if(l){const i=l.match(/scale\(([^,]+),([^)]+)\)/);i&&(h*=parseFloat(i[1]),p*=parseFloat(i[2]))}if(w){const i=w.match(/translate\(([^,]+),([^)]+)\)/);i&&(u+=parseFloat(i[1])*c*h,m+=parseFloat(i[2])*c*p)}n.setAttribute("transform",`translate(${u}, ${m}) scale(${h}, ${p})`)}else if(n.tagName==="path"){const l=n.getAttribute("d").replace(/([0-9.-]+)/g,t=>(parseFloat(t)*c).toFixed(6));n.setAttribute("d",l);const i=n.getAttribute("transform"),x=n.getAttribute("transform");if(x){const t=x.match(/scale\(([^,]+),([^)]+)\)/);t&&(h*=parseFloat(t[1]),p*=parseFloat(t[2]))}if(i){const t=i.match(/translate\(([^,]+),([^)]+)\)/);t&&(u+=parseFloat(t[1])*c*h,m+=parseFloat(t[2])*c*p)}try{const t=F.fromSVGPath(n.getAttribute("d"));t.position=[u,m],t.scale=[h,p],t.fill="transparent",t.stroke="white",t.strokeWidth=.05,this.add(t)}catch(t){console.error(t)}return}else if(n.tagName==="rect"){const w=parseFloat(n.getAttribute("width"))*c*h,l=parseFloat(n.getAttribute("height"))*c*p,i=parseFloat(n.getAttribute("x"))*c*h+u,x=parseFloat(n.getAttribute("y"))*c*p+m,t=new L(i,x,w,l);t.fill="white",t.anchor=v.TopLeft,this.add(t)}}y.childNodes.forEach(n=>{E(n,u,m,h,p)})};E(e,0,0,1,1),this.updateTransform(),s()})})}createElement(){return document.createElementNS("http://www.w3.org/2000/svg","g")}}function O(o){if(o instanceof M){const r=o.children.filter(e=>e instanceof F);if(r.length===0)throw new Error("Create animation can only be applied to groups containing WPathObjects.");const a=r.map(e=>e.path.clone()),s=r.map(e=>e.path.getLength());return P().onPlay(()=>r.forEach(e=>e.show())).onUpdate(e=>{if(e<=.5){const f=e*2;r.forEach((d,g)=>{d.path=a[g].truncate(f*s[g]),d.renderPath()})}else{const f=(e-.5)*2;r.forEach((d,g)=>{d.fill="white",d.fillOpacity=f,d.strokeWidth=.05*(1-f)})}}).duration(1)}if(o instanceof F){const r=o.path.clone(),a=r.getLength();return P().onPlay(()=>o.show()).onUpdate(s=>{o.path=r.truncate(s*a),o.renderPath()}).duration(.5)}throw new Error("")}export{O as C,M as W};
